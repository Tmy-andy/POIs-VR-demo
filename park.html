<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventure Park - Khu Vui Chơi Giải Trí</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #16A34A;
            --primary-light: #22C55E;
            --primary-dark: #15803D;
            --secondary: #F97316;
            --secondary-light: #FB923C;
            --cream: #ECFDF5;
            --cream-light: #F0FDF4;
            --dark: #1a1a1a;
            --dark-bg: rgba(26, 26, 26, 0.95);
            --white: #ffffff;
            --gray-text: #b0b0b0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Montserrat', sans-serif; background: var(--dark); min-height: 100vh; overflow-x: hidden; }
        .background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('https://images.unsplash.com/photo-1513889961551-628c1e5e2ee9?w=1920&q=85') center center / cover no-repeat; z-index: 0; }
        .background::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.5)); }
        .header { position: fixed; top: 0; left: 0; right: 0; display: flex; justify-content: space-between; align-items: flex-start; padding: 18px 20px; z-index: 100; pointer-events: none; }
        .header > * { pointer-events: auto; }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-icon { font-size: 40px; }
        .logo-text { font-family: 'Poppins', sans-serif; font-size: 16px; font-weight: 700; color: var(--white); letter-spacing: 2px; text-transform: uppercase; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        #menu-toggle { display: none; }
        .menu-box { background: var(--dark-bg); border-radius: 4px; overflow: hidden; box-shadow: 0 5px 30px rgba(0,0,0,0.3); max-width: 280px; }
        .menu-header { display: flex; align-items: stretch; }
        .lang-selector { flex: 1; display: flex; align-items: center; justify-content: center; gap: 8px; background: rgba(45,45,45,0.9); border: 1px solid rgba(255,255,255,0.18); border-radius: 3px; margin: 12px; padding: 10px 14px; color: var(--white); font-size: 11px; font-weight: 500; cursor: pointer; letter-spacing: 1px; }
        .flag { width: 22px; height: 14px; background: #da251d; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .flag::after { content: '\2605'; color: #ffff00; font-size: 9px; }
        .arrow { font-size: 8px; margin-left: 3px; opacity: 0.8; }
        .menu-btn { width: 50px; min-height: 46px; background: var(--primary); display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 5px; cursor: pointer; margin: 0; border-radius: 0; }
        .menu-btn .line { width: 20px; height: 2px; background: var(--white); transition: all 0.3s ease; }
        .menu-btn .close-icon { display: none; font-size: 22px; color: var(--white); font-weight: 300; }
        #menu-toggle:checked ~ .header .menu-btn .line { display: none; }
        #menu-toggle:checked ~ .header .menu-btn .close-icon { display: block; }
        .menu-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
        #menu-toggle:checked ~ .header .menu-body { max-height: 800px; }
        .menu-nav { padding: 15px 0 10px; border-top: 1px solid rgba(255,255,255,0.08); }
        .menu-nav a { display: block; padding: 12px 25px; color: var(--gray-text); text-decoration: none; font-size: 11px; font-weight: 500; letter-spacing: 2px; text-align: center; transition: all 0.2s ease; text-transform: uppercase; }
        .menu-nav a:hover { color: var(--white); background: rgba(255,255,255,0.03); }
        .menu-nav a.active { color: var(--primary-light); background: rgba(255,255,255,0.05); }
        .menu-nav .has-dropdown { position: relative; }
        .menu-nav .dropdown-toggle { display: flex; align-items: center; justify-content: center; gap: 6px; }
        .menu-nav .dropdown-toggle::after { content: '\25BC'; font-size: 8px; }
        .menu-nav .dropdown { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: rgba(0,0,0,0.3); }
        .menu-nav .dropdown.open { max-height: 500px; }
        .menu-nav .dropdown a { font-size: 10px; padding: 10px 20px; letter-spacing: 1px; }
        .menu-nav .book-btn { display: block; margin: 15px 20px 8px; padding: 14px 25px; background: var(--secondary); color: var(--white) !important; text-align: center; font-weight: 600; letter-spacing: 2px; font-size: 11px; border-radius: 4px; }
        .menu-nav .book-btn:hover { background: var(--secondary-light); }
        .menu-footer { padding: 15px 20px 22px; border-top: 1px solid rgba(255,255,255,0.05); }
        .menu-social { display: flex; justify-content: center; gap: 12px; margin-bottom: 16px; }
        .social-icon { width: 40px; height: 40px; border: 1px solid rgba(255,255,255,0.25); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--white); text-decoration: none; font-size: 14px; transition: all 0.2s ease; }
        .social-icon:hover { background: rgba(255,255,255,0.1); }
        .menu-weather { display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--gray-text); font-size: 11px; letter-spacing: 1px; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 95; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .overlay.is-active { opacity: 1; visibility: visible; }
        .content-panel { position: fixed; left: 20px; bottom: 75px; max-width: 650px; width: calc(100% - 40px); background: var(--dark-bg); backdrop-filter: blur(10px); border-radius: 8px; z-index: 99; opacity: 0; visibility: hidden; transform: translateY(20px); transition: all 0.4s ease; }
        .content-panel.is-active { opacity: 1; visibility: visible; transform: translateY(0); }
        .content-close { position: absolute; top: 12px; right: 12px; width: 32px; height: 32px; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; color: rgba(255,255,255,0.9); font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 9999; pointer-events: auto !important; }
        .content-close:hover { background: rgba(255,255,255,0.2); }
        .content-inner { padding: 28px 30px; max-height: 65vh; overflow-y: auto; }
        .content-panel h2 { font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: 600; color: var(--primary-light); margin-bottom: 18px; letter-spacing: 1px; }
        .content-panel p { font-size: 13px; color: rgba(255,255,255,0.75); line-height: 1.9; }
        .content-list { display: flex; flex-direction: column; gap: 12px; }
        .content-list-item { display: flex; gap: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 6px; cursor: pointer; transition: all 0.2s ease; }
        .content-list-item:hover { background: rgba(255,255,255,0.08); }
        .content-list-item img { width: 80px; height: 60px; object-fit: cover; border-radius: 4px; flex-shrink: 0; }
        .content-list-item-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .content-list-item-info h3 { font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; color: var(--cream); margin-bottom: 4px; }
        .content-list-item-info p { font-size: 11px; color: rgba(255,255,255,0.5); line-height: 1.4; margin: 0; }
        .item-badge { display: inline-block; background: var(--secondary); color: var(--white); font-size: 9px; padding: 2px 6px; border-radius: 3px; margin-left: 8px; font-weight: 600; }
        .item-badge.green { background: var(--primary); }
        .item-badge.blue { background: #3B82F6; }
        .content-detail { display: none; }
        .content-detail.active { display: block; }
        .back-btn { display: inline-flex; align-items: center; gap: 8px; color: rgba(255,255,255,0.7); font-size: 12px; cursor: pointer; margin-bottom: 15px; background: none; border: none; padding: 0; }
        .back-btn:hover { color: var(--white); }
        .detail-desc { font-size: 13px; color: rgba(255,255,255,0.75); line-height: 1.8; margin-bottom: 20px; }
        .sub-items-list { margin-top: 15px; }
        .sub-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.08); }
        .sub-item:last-child { border-bottom: none; }
        .sub-item-info { flex: 1; }
        .sub-item-name { font-size: 14px; font-weight: 500; color: var(--cream); margin-bottom: 3px; }
        .sub-item-desc { font-size: 11px; color: rgba(255,255,255,0.5); }
        .sub-item-price { font-size: 15px; font-weight: 600; color: var(--secondary); }
        .sub-item-price .original { font-size: 11px; color: rgba(255,255,255,0.4); text-decoration: line-through; margin-right: 8px; }
        .detail-info { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .detail-info-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: rgba(255,255,255,0.7); }
        .detail-info-item svg { width: 16px; height: 16px; opacity: 0.6; }
        .features-list { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; }
        .feature-tag { background: rgba(22,163,74,0.3); color: var(--cream); font-size: 11px; padding: 5px 12px; border-radius: 15px; border: 1px solid rgba(22,163,74,0.5); }
        .detail-price { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; margin-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); }
        .detail-price-value { font-size: 22px; font-weight: 600; color: var(--secondary); }
        .detail-price-value span { font-size: 13px; font-weight: 400; color: rgba(255,255,255,0.5); }
        .info-btn { background: var(--primary); color: var(--white); font-size: 12px; font-weight: 600; padding: 12px 25px; border: none; border-radius: 4px; cursor: pointer; letter-spacing: 1px; }
        .info-btn:hover { background: var(--primary-light); }
        .bottom-nav { position: fixed; bottom: 20px; left: 20px; display: flex; gap: 2px; z-index: 100; border-radius: 6px; overflow: hidden; }
        .bottom-nav a { background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); padding: 12px 18px; color: var(--gray-text); text-decoration: none; font-size: 11px; font-weight: 500; letter-spacing: 1px; transition: all 0.2s ease; }
        .bottom-nav a:hover { background: rgba(0,0,0,0.85); color: var(--white); }
        .bottom-nav a.active { background: var(--primary); color: var(--white); }
        .footer { position: fixed; bottom: 20px; right: 20px; font-size: 10px; color: rgba(255,255,255,0.4); z-index: 80; }
        .footer a { color: rgba(255,255,255,0.5); text-decoration: none; }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 15px; }
        .info-card { background: rgba(255,255,255,0.05); border-radius: 8px; padding: 15px; text-align: center; }
        .info-card-icon { font-size: 24px; margin-bottom: 8px; }
        .info-card-title { font-size: 12px; font-weight: 600; color: var(--cream); margin-bottom: 4px; }
        .info-card-value { font-size: 11px; color: rgba(255,255,255,0.6); }
        .safety-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; font-size: 11px; font-weight: 500; margin-right: 8px; margin-bottom: 8px; }
        .safety-badge.green { background: rgba(22,163,74,0.2); color: #22C55E; border: 1px solid rgba(22,163,74,0.3); }
        .safety-badge.yellow { background: rgba(234,179,8,0.2); color: #EAB308; border: 1px solid rgba(234,179,8,0.3); }
        .safety-badge.red { background: rgba(239,68,68,0.2); color: #EF4444; border: 1px solid rgba(239,68,68,0.3); }
        @media (max-width: 768px) {
            .content-panel { left: 10px; right: 10px; bottom: 70px; width: auto; }
            .bottom-nav { left: 10px; right: 10px; justify-content: center; }
            .bottom-nav a { padding: 10px 12px; font-size: 10px; }
            .content-inner { padding: 20px; }
            .info-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <input type="checkbox" id="menu-toggle">
    <div class="background"></div>
    <div class="overlay" id="overlay"></div>
    <header class="header">
        <div class="logo">
            <div class="logo-icon"></div>
            <span class="logo-text">Adventure Park</span>
        </div>
        <div class="menu-box">
            <div class="menu-header">
                <div class="lang-selector">
                    <span class="flag"></span>
                    <span>TIENG VIET</span>
                    <span class="arrow">&#9660;</span>
                </div>
                <label for="menu-toggle" class="menu-btn">
                    <span class="line"></span>
                    <span class="line"></span>
                    <span class="line"></span>
                    <span class="close-icon">&#10005;</span>
                </label>
            </div>
            <div class="menu-body">
                <nav class="menu-nav">
                    <a href="#" data-section="home">TRANG CHU</a>
                    <a href="#" data-section="about">GIOI THIEU</a>
                    <div class="has-dropdown">
                        <a href="#" class="dropdown-toggle" data-dropdown="attractions">DIEM THAM QUAN</a>
                        <div class="dropdown" id="dropdown-attractions">
                            <a href="#" data-section="attractions-thrill">Cam giac manh</a>
                            <a href="#" data-section="attractions-family">Tro choi gia dinh</a>
                            <a href="#" data-section="attractions-kids">Khu tre em</a>
                            <a href="#" data-section="attractions-interactive">Trai nghiem tuong tac</a>
                            <a href="#" data-section="attractions-education">Giao duc kham pha</a>
                            <a href="#" data-section="attractions-nature">Thien nhien sinh thai</a>
                            <a href="#" data-section="attractions-culture">Van hoa lich su</a>
                            <a href="#" data-section="attractions-show">Khu bieu dien</a>
                            <a href="#" data-section="attractions-checkin">Check-in dac biet</a>
                        </div>
                    </div>
                    <a href="#" data-section="map">BAN DO & THAM QUAN</a>
                    <a href="#" data-section="tickets">VE & GIA VE</a>
                    <a href="#" data-section="games">TRO CHOI & HOAT DONG</a>
                    <a href="#" data-section="schedule">LICH BIEU & SU KIEN</a>
                    <a href="#" data-section="food">AN UONG & DICH VU</a>
                    <a href="#" data-section="services">DICH VU HO TRO</a>
                    <a href="#" data-section="info">THONG TIN THAM QUAN</a>
                    <a href="#" data-section="contact">LIEN HE</a>
                    <a href="#" class="book-btn" data-section="tickets">XEM GIA VE</a>
                </nav>
                <div class="menu-footer">
                    <div class="menu-social">
                        <a href="#" class="social-icon">&#128222;</a>
                        <a href="#" class="social-icon">f</a>
                        <a href="#" class="social-icon">&#128247;</a>
                    </div>
                    <div class="menu-weather">
                        <span>ADVENTURE PARK</span>
                        <span>&#127881;</span>
                        <span>8:00 - 21:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div class="content-panel" id="content-panel">
        <button class="content-close" id="close-btn" type="button">&#10005;</button>
        <div class="content-inner">
            <h2 id="panel-title">Adventure Park</h2>
            <div id="panel-content"></div>
        </div>
    </div>
    <nav class="bottom-nav">
        <a href="#" data-section="careers">Tuyen dung</a>
        <a href="#" data-section="promotion">Uu dai</a>
        <a href="#" data-section="gallery">Thu vien</a>
    </nav>
    <div class="footer">
        &#169; 2026 <a href="#">Adventure Park</a>. Made with &#127881;
    </div>
    <script>
        let contentData = {};
        let settings = {};
        const panel = document.getElementById('content-panel');
        const panelTitle = document.getElementById('panel-title');
        const panelContent = document.getElementById('panel-content');
        const menuToggle = document.getElementById('menu-toggle');
        const overlay = document.getElementById('overlay');
        let currentSection = null;
        let currentDetailItem = null;
        let fromBottomNav = false;

        async function loadContentData() {
            try {
                const response = await fetch('./assets/data/park-content.json');
                const data = await response.json();
                settings = data.settings || {};
                contentData = data;
            } catch (error) {
                console.error('Error loading content data:', error);
            }
        }

        function renderListView(section) {
            const data = contentData[section];
            if (!data || data.type !== 'list') return '';
            let html = '<div class="content-list">';
            data.items.forEach(function(item) {
                let badgeHtml = item.badge ? '<span class="item-badge ' + (item.badgeClass || '') + '">' + item.badge + '</span>' : '';
                html += '<div class="content-list-item" data-item-id="' + item.id + '" data-section="' + section + '">';
                html += '<img src="' + item.image + '" alt="' + item.name + '">';
                html += '<div class="content-list-item-info">';
                html += '<h3>' + item.name + badgeHtml + '</h3>';
                html += '<p>' + item.shortDesc + '</p>';
                html += '</div></div>';
            });
            html += '</div>';
            return html;
        }

        function renderSubItems(subItems) {
            if (!subItems || subItems.length === 0) return '';
            let html = '<div class="sub-items-list">';
            subItems.forEach(function(item) {
                let priceHtml = '';
                if (item.price) {
                    let originalHtml = item.original ? '<span class="original">' + item.original + (settings.currency || 'd') + '</span>' : '';
                    priceHtml = '<div class="sub-item-price">' + originalHtml + item.price + (settings.currency || 'd') + '</div>';
                }
                html += '<div class="sub-item">';
                html += '<div class="sub-item-info">';
                html += '<div class="sub-item-name">' + item.name + '</div>';
                html += '<div class="sub-item-desc">' + (item.desc || '') + '</div>';
                html += '</div>' + priceHtml + '</div>';
            });
            html += '</div>';
            return html;
        }

        function renderFeatures(features) {
            if (!features || features.length === 0) return '';
            let html = '<div class="features-list">';
            features.forEach(function(f) {
                html += '<span class="feature-tag">' + f + '</span>';
            });
            html += '</div>';
            return html;
        }

        function renderInfoGrid(info) {
            if (!info) return '';
            let html = '<div class="info-grid">';
            if (info.age) html += '<div class="info-card"><div class="info-card-icon">&#128118;</div><div class="info-card-title">Do tuoi</div><div class="info-card-value">' + info.age + '</div></div>';
            if (info.duration) html += '<div class="info-card"><div class="info-card-icon">&#9201;</div><div class="info-card-title">Thoi luong</div><div class="info-card-value">' + info.duration + '</div></div>';
            if (info.height) html += '<div class="info-card"><div class="info-card-icon">&#128207;</div><div class="info-card-title">Chieu cao toi thieu</div><div class="info-card-value">' + info.height + '</div></div>';
            if (info.capacity) html += '<div class="info-card"><div class="info-card-icon">&#128101;</div><div class="info-card-title">Suc chua</div><div class="info-card-value">' + info.capacity + '</div></div>';
            html += '</div>';
            return html;
        }

        function renderSafetyBadges(safety) {
            if (!safety) return '';
            let html = '<div style="margin-top:15px">';
            if (safety.level) {
                var cls = safety.level === 'high' ? 'red' : (safety.level === 'medium' ? 'yellow' : 'green');
                var txt = safety.level === 'high' ? 'Cam giac manh' : (safety.level === 'medium' ? 'Trung binh' : 'An toan');
                html += '<span class="safety-badge ' + cls + '">&#9888; ' + txt + '</span>';
            }
            if (safety.supervision) html += '<span class="safety-badge green">&#128100; ' + safety.supervision + '</span>';
            html += '</div>';
            return html;
        }

        function renderDetailView(section, itemId) {
            const data = contentData[section];
            if (!data || !data.items) return '';
            const item = data.items.find(function(i) { return i.id === itemId; });
            if (!item) return '';

            let subItemsHtml = item.subItems ? renderSubItems(item.subItems) : '';
            let featuresHtml = item.features ? renderFeatures(item.features) : '';
            let infoGridHtml = item.info ? renderInfoGrid(item.info) : '';
            let safetyHtml = item.safety ? renderSafetyBadges(item.safety) : '';

            let infoHtml = '';
            if (item.address || item.hours || item.phone || item.location || item.area) {
                infoHtml = '<div class="detail-info">';
                if (item.address) infoHtml += '<div class="detail-info-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"></path><circle cx="12" cy="10" r="3"></circle></svg><span>' + item.address + '</span></div>';
                if (item.hours) infoHtml += '<div class="detail-info-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><span>' + item.hours + '</span></div>';
                if (item.area) infoHtml += '<div class="detail-info-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect></svg><span>' + item.area + '</span></div>';
                infoHtml += '</div>';
            }

            let priceHtml = '';
            if (item.price) {
                priceHtml = '<div class="detail-price"><div class="detail-price-value">' + item.price + ' ' + (settings.currency || 'd') + '<span>/' + (item.unit || 've') + '</span></div><button class="info-btn">Xem them</button></div>';
            }

            let requirementsHtml = '';
            if (item.requirements) {
                requirementsHtml = '<div style="margin-top:15px"><strong style="color:var(--cream)">Yeu cau:</strong><ul style="margin:8px 0 0 20px;color:rgba(255,255,255,0.7);font-size:12px;line-height:1.8">';
                item.requirements.forEach(function(r) { requirementsHtml += '<li>' + r + '</li>'; });
                requirementsHtml += '</ul></div>';
            }
            if (item.benefits) {
                requirementsHtml += '<div style="margin-top:15px"><strong style="color:var(--cream)">Quyen loi:</strong><ul style="margin:8px 0 0 20px;color:rgba(255,255,255,0.7);font-size:12px;line-height:1.8">';
                item.benefits.forEach(function(b) { requirementsHtml += '<li>' + b + '</li>'; });
                requirementsHtml += '</ul></div>';
            }

            let includesHtml = item.includes ? '<div style="margin-top:15px"><strong style="color:var(--cream)">Bao gom:</strong> ' + item.includes.join(', ') + '</div>' : '';
            let noteHtml = item.note ? '<div style="margin-top:15px;padding:10px;background:rgba(22,163,74,0.2);border-radius:4px;font-size:12px;color:var(--cream)">&#128161; ' + item.note + '</div>' : '';

            return '<div class="content-detail active"><button class="back-btn" data-section="' + section + '">&#8592; Quay lai</button><h2 style="margin-bottom:15px">' + item.name + '</h2>' + infoHtml + safetyHtml + '<p class="detail-desc">' + (item.fullDesc || '') + '</p>' + infoGridHtml + subItemsHtml + featuresHtml + requirementsHtml + includesHtml + noteHtml + priceHtml + '</div>';
        }

        function updateContent(section, itemId) {
            itemId = itemId || null;
            const data = contentData[section];
            if (!data) return;
            if (itemId) {
                panelTitle.style.display = 'none';
                panelContent.innerHTML = renderDetailView(section, itemId);
                currentDetailItem = itemId;
                var backBtn = panelContent.querySelector('.back-btn');
                if (backBtn) {
                    backBtn.addEventListener('click', function() { updateContent(section); });
                }
            } else if (data.type === 'list') {
                panelTitle.style.display = 'block';
                panelTitle.textContent = data.title;
                panelContent.innerHTML = renderListView(section);
                currentDetailItem = null;
                panelContent.querySelectorAll('.content-list-item').forEach(function(item) {
                    item.addEventListener('click', function() {
                        updateContent(item.dataset.section, item.dataset.itemId);
                    });
                });
            } else {
                panelTitle.style.display = 'block';
                panelTitle.textContent = data.title;
                panelContent.innerHTML = '<p>' + data.content.replace(/\n/g, '<br>') + '</p>';
                currentDetailItem = null;
            }
            currentSection = section;
            document.querySelectorAll('.menu-nav a, .bottom-nav a').forEach(function(a) { a.classList.remove('active'); });
            var activeLink = document.querySelector('[data-section="' + section + '"]');
            if (activeLink) activeLink.classList.add('active');
        }

        function closeAll() {
            menuToggle.checked = false;
            panel.classList.remove('is-active');
            overlay.classList.remove('is-active');
            document.querySelectorAll('.menu-nav a, .bottom-nav a').forEach(function(a) { a.classList.remove('active'); });
            currentSection = null;
            currentDetailItem = null;
        }

        async function init() {
            await loadContentData();

            document.querySelectorAll('.dropdown-toggle').forEach(function(toggle) {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    var dropdownId = 'dropdown-' + toggle.dataset.dropdown;
                    var dropdown = document.getElementById(dropdownId);
                    if (dropdown) dropdown.classList.toggle('open');
                });
            });

            document.querySelectorAll('.menu-nav a[data-section]').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    updateContent(link.dataset.section);
                    panel.classList.add('is-active');
                });
            });

            document.querySelectorAll('.bottom-nav a[data-section]').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    var section = link.dataset.section;
                    var isSameSection = (currentSection === section);
                    var isPanelActive = panel.classList.contains('is-active');
                    if (isSameSection && isPanelActive) {
                        closeAll();
                    } else {
                        fromBottomNav = true;
                        updateContent(section);
                        if (!menuToggle.checked) menuToggle.checked = true;
                        panel.classList.add('is-active');
                        overlay.classList.add('is-active');
                        setTimeout(function() { fromBottomNav = false; }, 100);
                    }
                });
            });

            overlay.addEventListener('click', function() { closeAll(); });

            menuToggle.addEventListener('change', function() {
                if (fromBottomNav) return;
                if (menuToggle.checked) {
                    updateContent('home');
                    panel.classList.add('is-active');
                    overlay.classList.add('is-active');
                } else {
                    panel.classList.remove('is-active');
                    overlay.classList.remove('is-active');
                    document.querySelectorAll('.menu-nav a, .bottom-nav a').forEach(function(a) { a.classList.remove('active'); });
                    currentSection = null;
                }
            });

            document.getElementById('close-btn').addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                closeAll();
            });
        }
        init();
    </script>
</body>
</html>
